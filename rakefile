require 'rake/clean'

MACROS = "-D_GLIBCXX_USE_NANOSLEEP"
CPP_FLAGS = "--std=c++11"
LINK_FLAGS = "-pthread"

TARGET = 'vita.out'

file 'ortus.hpp'
file 'orcus.hpp'
file 'vita.hpp'
file 'test.cpp'

file TARGET => ['test.cpp', 'ortus.hpp', 'orcus.hpp', 'vita.hpp'] do |t|
  sh "g++ #{CPP_FLAGS} #{LINK_FLAGS} #{MACROS} #{t.prerequisites[0]} -o #{t.name}"
end

task :compile => [TARGET]

task :run => [:compile] do
  sh "./#{TARGET}"
end

CLEAN.include TARGET

task :default => [:run]
